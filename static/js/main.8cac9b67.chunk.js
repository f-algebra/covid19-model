(this["webpackJsonpc19-dash"]=this["webpackJsonpc19-dash"]||[]).push([[0],{75:function(e,t,a){e.exports=a(88)},80:function(e,t,a){},88:function(e,t,a){"use strict";a.r(t);var i=a(0),n=a.n(i),s=a(12),r=a.n(s),o=(a(80),a(18)),c=a(13),l=a(28),u=a(29),m=a(49),d=a(121),p=a(137),h=a(41),v=a.n(h),f=a(11),y=a(119),g=a(120),E=a(63);function b(e){return e instanceof Array?e[0]:e}var D=a(31),C=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var i;Object(o.a)(this,a),(i=t.call(this,e)).state=void 0;var n=D.a.create((function(e){return i.setState(e||{})}));return i.state=Object(m.a)({start:e.start,stop:e.stop,model:e.model,subscription:e.model.updates.subscribe(n)},e.model.getParams()),i}return Object(c.a)(a,[{key:"componentWillUnmount",value:function(){this.state.subscription.unsubscribe()}},{key:"render",value:function(){var e=this,t=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=(t-e)/(a-1);return Object(f.range)(a).map((function(t){return e+t*i}))}(this.state.start,this.state.stop),a=t.map((function(t){return e.state.model.run(t,e.state)}));return n.a.createElement("div",null,n.a.createElement("h2",null,"Step 2. Customize your infectiousness function"),n.a.createElement(d.a,{container:!0},"Possibly skip this step if you haven't read much epidemiology research on COVID-19. I certainly haven't."),n.a.createElement(d.a,{container:!0},n.a.createElement(v.a,{data:[{x:t,y:a,type:"scatter",mode:"lines+markers",marker:{color:"red"}}],layout:{autosize:!0,yaxis:{title:{text:"Infectiousness"}},xaxis:{title:{text:"Days after initial infection"}}}})),n.a.createElement(d.a,{container:!0},n.a.createElement(d.a,{item:!0,xs:5},"Non-infectious until ",this.state.noninfectiousUntil," days after infection"),n.a.createElement(d.a,{item:!0,xs:7},n.a.createElement(p.a,{step:.1,value:this.state.noninfectiousUntil,min:this.state.start,max:this.state.stop,onChange:function(t,a){return e.state.model.setNoninfectiousUntil(b(a))}}))),n.a.createElement(d.a,{container:!0},n.a.createElement(d.a,{item:!0,xs:5},"Fully infectious ",this.state.rampUpAfter," days after infection"),n.a.createElement(d.a,{item:!0,xs:7},n.a.createElement(p.a,{step:.1,value:this.state.rampUpAfter,min:this.state.start,max:this.state.stop,onChange:function(t,a){return e.state.model.setRampUpAfter(b(a))}}))),n.a.createElement(d.a,{container:!0},n.a.createElement(d.a,{item:!0,xs:5},"Infectiousness decreases after ",this.state.rampDownAfter," days"),n.a.createElement(d.a,{item:!0,xs:7},n.a.createElement(p.a,{step:.1,value:this.state.rampDownAfter,min:this.state.start,max:this.state.stop,onChange:function(t,a){return e.state.model.setRampDownAfter(b(a))}}))),n.a.createElement(d.a,{container:!0},n.a.createElement(d.a,{item:!0,xs:5},"Recovered ",this.state.totalDays," days after infection"),n.a.createElement(d.a,{item:!0,xs:7},n.a.createElement(p.a,{step:.1,value:this.state.totalDays,min:this.state.start,max:this.state.stop,onChange:function(t,a){return e.state.model.setTotalDays(b(a))}}))),n.a.createElement(d.a,{container:!0},n.a.createElement(d.a,{item:!0,xs:5},"Basic Reproduction Number R",n.a.createElement("sub",null,"0")," is"," ",this.state.basicReproduction),n.a.createElement(d.a,{item:!0,xs:7},n.a.createElement(p.a,{step:.1,value:this.state.basicReproduction,min:0,max:10,onChange:function(t,a){return e.state.model.setBasicReproduction(b(a))}}))))}}]),a}(n.a.PureComponent),x=a(136),k=a(131),R=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var i;Object(o.a)(this,a),(i=t.call(this,e)).state=void 0,i.subscription=void 0,i.dataModel=void 0,i.dataModel=e.dataModel,i.state=i.dataModel.getData();var n=D.a.create((function(e){return i.setState(e||{})}));return i.subscription=e.dataModel.updates.subscribe(n),i}return Object(c.a)(a,[{key:"componentWillUnmount",value:function(){this.subscription.unsubscribe()}},{key:"render",value:function(){var e=this,t=new Array;this.state.regions.forEach((function(e){t.push(n.a.createElement(x.a,{value:e,key:e},e))})),t.push(n.a.createElement(x.a,{value:"",key:""},"All Countries/Regions"));var a=new Array;this.state.provinces.length>1&&(this.state.provinces.forEach((function(e){var t=e;t||(t="Other"),a.push(n.a.createElement(x.a,{value:e,key:t},t))})),a.push(n.a.createElement(x.a,{value:"",key:""},"All Provinces/States")));var i=this.state.dateRange,s=this.state.dailyCumulativeCases;return n.a.createElement("div",null,n.a.createElement("h2",null,"Step 1. Choose live data to build predictions from"),n.a.createElement(d.a,{container:!0},"Pick a country/region and a province/state to predict the spread in that area."),n.a.createElement(d.a,{container:!0},n.a.createElement(v.a,{data:[{x:i,y:s,type:"scatter",mode:"lines+markers",marker:{color:"red"}}],layout:{autosize:!0,yaxis:{title:{text:"Reported Cases (Cumulative)"}},xaxis:{title:{text:"Date"}}}})),n.a.createElement(d.a,{container:!0},n.a.createElement(d.a,{item:!0,xs:3},"Choose a Country/Region"),n.a.createElement(d.a,{item:!0,xs:9},n.a.createElement(k.a,{fullWidth:!0,onChange:function(t){e.dataModel.setRegion(t.target.value)}},t)),n.a.createElement(d.a,{item:!0,xs:3},"Choose a Province/State"),n.a.createElement(d.a,{item:!0,xs:9},n.a.createElement(k.a,{fullWidth:!0,disabled:0===a.length,onChange:function(t){e.dataModel.setProvince(t.target.value)}},a))))}}]),a}(n.a.PureComponent),O=a(129),P=a(132),j=function(){function e(){Object(o.a)(this,e),this.params={noninfectiousUntil:5.2,rampUpAfter:10.5,rampDownAfter:15.7,totalDays:20.9,basicReproduction:2.4},this.updates=new P.a}return Object(c.a)(e,[{key:"getParams",value:function(){return this.params}},{key:"updateParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.params;this.params=Object.assign(this.params,e),this.updates.next(e)}},{key:"setBasicReproduction",value:function(e){this.updateParams({basicReproduction:e})}},{key:"setNoninfectiousUntil",value:function(e){this.updateParams({noninfectiousUntil:Object(f.min)([e,this.params.rampUpAfter])||e})}},{key:"setRampUpAfter",value:function(e){this.updateParams({rampUpAfter:Object(f.max)([this.params.noninfectiousUntil,Object(f.min)([e,this.params.rampDownAfter])])||e})}},{key:"setRampDownAfter",value:function(e){this.updateParams({rampDownAfter:Object(f.max)([this.params.rampUpAfter,Object(f.min)([e,this.params.totalDays])])||e})}},{key:"setTotalDays",value:function(e){this.updateParams({totalDays:Object(f.max)([e,this.params.rampDownAfter])||e})}},{key:"run",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.params,a=t.noninfectiousUntil,i=t.rampUpAfter,n=t.rampDownAfter,s=t.totalDays,r=t.basicReproduction/((s+n-(i+a))/2);return e<a||e>s?0:e<i?r*((e-a)/(i-a)):e<n?r:r*((s-e)/(s-n))}}]),e}(),S=a(68),w=a(127),A=a(130),U=a(134),F=w.a("2020-01-22"),M=function(){function e(){Object(o.a)(this,e),this.historicalData={regions:new Map,dateRange:[],dailyCumulativeCases:[]},this.updates=new P.a,this.fetch()}return Object(c.a)(e,[{key:"getHistoricalData",value:function(){return this.historicalData}}]),Object(c.a)(e,[{key:"fetch",value:function(){var e=this;Object(S.a)("https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv").then((function(t){return e.updateRawData(t)}))}},{key:"updateRawData",value:function(t){if(0!==t.length){var a=new Map,i=e.loadDateRange(t[0]),n=i.map((function(e){return A.a(e,"M/d/yy")}));t.forEach((function(e){var t=e["Country/Region"],i=e["Province/State"]||"";if(t){for(var s={dailyCumulativeCases:new Array},r="0.0",o=0;o<n.length;o++){var c=e[n[o]]||r;r=c,s.dailyCumulativeCases.push(parseInt(c))}var l=a.get(t)||{provinces:new Map,dailyCumulativeCases:[]};a.set(t,l),l.provinces.set(i,s)}})),a.forEach((function(t){e.calculateCaseSum(t)})),this.historicalData={regions:a,dateRange:i,dailyCumulativeCases:[]},e.calculateCaseSum(this.historicalData),this.updates.next(this.historicalData)}}}],[{key:"loadDateRange",value:function(e){for(var t=F,a=[];A.a(t,"M/d/yy")in e;)a.push(t),t=U.a(t,{days:1});return a}},{key:"calculateCaseSum",value:function(e){var t;t="provinces"in e?Array.from(e.provinces.values()):Array.from(e.regions.values()),e.dailyCumulativeCases=[];for(var a=0;a<t[0].dailyCumulativeCases.length;a++){for(var i=0,n=0;n<t.length;n++)i+=t[n].dailyCumulativeCases[a];e.dailyCumulativeCases.push(i)}}}]),e}(),z=a(133),I=a(128);var H=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var i;Object(o.a)(this,a),(i=t.call(this,e)).state=void 0,i.model=void 0;var n=D.a.create((function(e){return i.setState(e||{})})),s=D.a.create((function(e){i.setState(e||{})}));return i.model=e.model,i.state=Object(m.a)({subscriptions:[e.model.predictionUpdates.subscribe(n),e.model.paramUpdates.subscribe(s)]},e.model.getLatestPrediction()),i}return Object(c.a)(a,[{key:"componentWillUnmount",value:function(){this.state.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"render",value:function(){var e,t,a=this,i=this.state.dateRange,s=this.state.dailyCumulativeCases,r=this.state.historicalData.dateRange,o=this.state.historicalData.dailyCumulativeCases,c=this.state.dailyInfectiousCases,l=this.state.dailyHospitalizedCases,u=this.model.getPredictFromDate();return e=u?A.a(u,"yyyy-MM-dd"):"",n.a.createElement("div",null,n.a.createElement("h2",null,"Step 3. Configure other parameters of the model"),n.a.createElement(d.a,{container:!0},n.a.createElement(d.a,{item:!0,xs:5},Object(f.round)(100*this.state.detectionRatio),"% of cases are reported"),n.a.createElement(d.a,{item:!0,xs:7},n.a.createElement(p.a,{step:1,min:0,max:100,value:Object(f.round)(100*this.state.detectionRatio),onChange:function(e,t){return a.model.setDetectionRatio(b(t)/100)}}))),n.a.createElement(d.a,{container:!0},n.a.createElement(d.a,{item:!0,xs:5},Object(f.round)(100*this.state.hospitalizationRatio),"% reported cases are hospitalized"),n.a.createElement(d.a,{item:!0,xs:7},n.a.createElement(p.a,{step:1,min:0,max:100,value:Object(f.round)(100*this.state.hospitalizationRatio),onChange:function(e,t){return a.model.setHospitalizationRatio(b(t)/100)}}))),n.a.createElement(d.a,{container:!0},n.a.createElement(d.a,{item:!0,xs:5},"Social-distancing has"," ",Object(f.round)(100*this.state.socialDistancingEffect),"% effectiveness"),n.a.createElement(d.a,{item:!0,xs:7},n.a.createElement(p.a,{step:1,min:0,max:100,value:Object(f.round)(100*this.state.socialDistancingEffect),onChange:function(e,t){return a.model.setSocialDistancingEffect(b(t)/100)}}))),n.a.createElement(d.a,{container:!0},n.a.createElement(d.a,{item:!0,xs:5},"Population (",this.model.historicalData.getChoiceText(),")"),n.a.createElement(d.a,{item:!0,xs:7},n.a.createElement(z.a,{value:(t=this.state.population,Number.isNaN(t)?"":t.toString()),onChange:function(e){return a.model.setPopulation(parseInt(e.target.value))}}))),n.a.createElement("div",{style:{height:30}}),n.a.createElement(d.a,{container:!0},n.a.createElement(d.a,{item:!0,xs:5},"Start the prediction from ",e),n.a.createElement(d.a,{item:!0,xs:7},n.a.createElement(p.a,{step:1,min:0,max:this.state.historicalData.dateRange.length-1,value:this.state.predictFromDay||0,onChange:function(e,t){return a.model.setPredictFromDay(b(t))}}))),n.a.createElement(d.a,{container:!0},n.a.createElement(d.a,{item:!0,xs:5},"Predict ",this.state.predictForDays," days into the future"),n.a.createElement(d.a,{item:!0,xs:7},n.a.createElement(p.a,{step:1,min:0,max:730,value:this.state.predictForDays,onChange:function(e,t){return a.model.setPredictForDays(b(t))}}))),n.a.createElement("h2",null,"Step 4. Run the model"),n.a.createElement(d.a,{container:!0,style:{marginTop:"20px",marginBottom:"20px"}},n.a.createElement(I.a,{onClick:function(e){return a.model.updatePrediction()}},"Click me to run the model")),n.a.createElement(d.a,{container:!0},"Hospitalizations will peak at ",Object(f.round)(this.state.peakHospitalizedCases),"."),n.a.createElement(d.a,{container:!0},n.a.createElement(v.a,{data:[{x:r,y:o,type:"scatter",mode:"lines",marker:{color:"red"},name:"Reported cases (live data)"},{x:i,y:s,type:"scatter",mode:"lines",marker:{color:"blue"},name:"Reported cases (predicted)"},{x:i,y:c,type:"scatter",mode:"lines",marker:{color:"green"},name:"Infectious people (predicted)"},{x:i,y:l,type:"scatter",mode:"lines",marker:{color:"black"},name:"Hospitalized people (predicted)"}],layout:{yaxis:{title:{text:"Cases"}},xaxis:{title:{text:"Date"}},height:800,width:700,legend:{orientation:"h",yanchor:"bottom",y:1}}})))}}]),a}(n.a.PureComponent),_=function(){function e(t,a){var i=this;Object(o.a)(this,e),this.params=void 0,this.latestPrediction=void 0,this.infectivity=void 0,this.historicalData=void 0,this.predictionUpdates=new P.a,this.paramUpdates=new P.a,this.infectivity=t,this.historicalData=a,this.params={population:753e7,detectionRatio:.3,predictFromDay:null,stepSizeDays:.05,predictForDays:10,socialDistancingEffect:0,hospitalizationRatio:.1},this.latestPrediction=this.predict(),a.updates.subscribe(D.a.create((function(e){return i.updatePrediction()}))),t.updates.subscribe(D.a.create((function(e){return i.updateParams({})})))}return Object(c.a)(e,[{key:"getPredictFromDate",value:function(){var e=this.latestPrediction.historicalData.dateRange;return 0===e.length?null:null==this.params.predictFromDay?e[e.length-1]:E.a(e[0],this.params.predictFromDay)}},{key:"setPredictFromDay",value:function(e){this.updateParams({predictFromDay:e})}},{key:"setPredictForDays",value:function(e){this.updateParams({predictForDays:e})}},{key:"getLatestPrediction",value:function(){return this.latestPrediction}},{key:"setPopulation",value:function(e){this.updateParams({population:e})}},{key:"setDetectionRatio",value:function(e){this.updateParams({detectionRatio:e})}},{key:"setSocialDistancingEffect",value:function(e){this.updateParams({socialDistancingEffect:e})}},{key:"setHospitalizationRatio",value:function(e){this.updateParams({hospitalizationRatio:e})}},{key:"updateParams",value:function(e){this.params=Object.assign(this.params,e),this.paramUpdates.next(e)}},{key:"updatePrediction",value:function(){this.latestPrediction=this.predict(),this.predictionUpdates.next(this.latestPrediction)}},{key:"predict",value:function(){var e=this,t=this.params,a=t.population,i=t.detectionRatio,n=t.stepSizeDays,s=t.predictForDays,r=t.socialDistancingEffect,o=t.hospitalizationRatio,c=this.historicalData.getData(),l=null==this.params.predictFromDay?c.dateRange.length:this.params.predictFromDay+1,u=E.a(c.dateRange[0],this.params.predictForDays+l),m=function(e,t){var a=e,i=t;console.assert(y.a(i,a));for(var n=[];g.a(a,i);)n.push(a),a=E.a(a,1);return n}(c.dateRange[0],u),d=Object(f.ceil)(1/n),p=d*m.length,h=this.infectivity.getParams().totalDays*d,v=[0],b=[0],D=[0],C=[0];Object(f.range)(1,p).forEach((function(t){var s=Object(f.floor)(t/d);if(y.a(l,s))D.push(c.dailyCumulativeCases[s]/i),v.push(D[t]-D[t-1]);else{var o=0;Object(f.range)(0,t).forEach((function(a){o+=v[a]*e.infectivity.run((t-1-a)*n)}));var u=1-D[t-1]/a;v.push(o*n*u*(1-r)),D.push(D[t-1]+v[t])}t>=h?b.push(v[t-h]):b.push(0),C.push(C[t-1]+b[t])}));var x=[],k=[],R=[],O=[],P=0;return Object(f.range)(m.length).forEach((function(e){var t=(e+1)*d-1;x.push(D[t]*i),k.push(C[t]*i),R.push(D[t]-C[t]),O.push(R[e]*i*o),P=Object(f.max)([O[e],P])||P})),{dailyCumulativeCases:x,dailyRecoveredCases:k,dailyInfectiousCases:R,dailyHospitalizedCases:O,peakHospitalizedCases:P,dateRange:m,predictFromDay:l,predictForDays:s,population:a,detectionRatio:i,socialDistancingEffect:r,stepSizeDays:n,historicalData:c,hospitalizationRatio:o}}}]),e}(),N=function(){function e(t){var a=this;Object(o.a)(this,e),this.params=void 0,this.dataService=void 0,this.dataSeries=void 0,this.updates=new P.a,this.dataService=t,this.params={province:null,region:null};var i=D.a.create((function(e){return a.updateParams({})}));t.updates.subscribe(i),this.dataSeries=this.calculate()}return Object(c.a)(e,[{key:"getData",value:function(){return this.dataSeries}},{key:"updateParams",value:function(e){this.params=Object.assign(this.params,e),this.dataSeries=this.calculate(),this.updates.next(this.dataSeries)}},{key:"setRegion",value:function(e){this.updateParams({region:e,province:null})}},{key:"setProvince",value:function(e){this.updateParams({province:e})}},{key:"getChoiceText",value:function(){return this.params.region?this.params.province?this.params.province:this.params.region:"Worldwide"}},{key:"calculate",value:function(){var e,t,a=this.dataService.getHistoricalData();if(this.params.region){var i,n,s=a.regions.get(this.params.region);if(t=Array.from((null===s||void 0===s?void 0:s.provinces.keys())||[]),this.params.province)e=(null===s||void 0===s||null===(i=s.provinces)||void 0===i||null===(n=i.get(this.params.province))||void 0===n?void 0:n.dailyCumulativeCases)||[];else e=(null===s||void 0===s?void 0:s.dailyCumulativeCases)||[]}else e=a.dailyCumulativeCases,t=[];return{dateRange:a.dateRange,dailyCumulativeCases:e,regions:Array.from(this.dataService.getHistoricalData().regions.keys()),provinces:t}}}]),e}(),W=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var i;Object(o.a)(this,a),(i=t.call(this,e)).state=void 0;var n=new j,s=new M,r=new N(s),c=new _(n,r);return i.state={infectivityModel:n,historicalDataModel:r,outbreakModel:c},i}return Object(c.a)(a,[{key:"render",value:function(){return n.a.createElement(O.a,{maxWidth:"sm"},n.a.createElement("h1",null,"COVID-19 Predictive Model"),n.a.createElement(d.a,{container:!0},n.a.createElement(R,{dataModel:this.state.historicalDataModel})),n.a.createElement(d.a,{container:!0},n.a.createElement(C,{start:0,stop:50,model:this.state.infectivityModel})),n.a.createElement(d.a,{container:!0},n.a.createElement(H,{model:this.state.outbreakModel})))}}]),a}(n.a.Component);r.a.render(n.a.createElement(W,null),document.getElementById("root"))}},[[75,1,2]]]);
//# sourceMappingURL=main.8cac9b67.chunk.js.map